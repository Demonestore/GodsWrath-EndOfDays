// File: Assets/GameSystem/Scripts/NoEscapeGodWars_FullBuild.cs
// NoEscapeGodWars â€” server API mode (no local SQLite)
// Unity 2021+ (Mono/.NET 4.x)

using System;
using System.Collections.Generic;
using UnityEngine;
using UnityEngine.Networking;
using System.Threading.Tasks;

namespace NoEscapeGodWars
{
    #region Core Types
    public enum Faction { Player, Boss, Neutral }
    public enum DamageType { Melee, Magic, Ranged, Fire, Ice, Shadow, Holy, Lightning, Water, Poison }
    public enum School { Normal, Ancient, Lunar, God }
    public enum Slot { Head, Body, Legs, Feet, Hands, Cape, Amulet, Ring, Weapon, Shield, Gloves, Boots }
    public enum WeaponKind { None, Rapier, Longsword, Maul, Staff, Bow, Crossbow, Whip, Mace, Spear, Axe }
    public enum Rarity { Common, Uncommon, Rare, Epic, Barrows, Mythic, Divine, Unique }
    public enum TickSpeed { T2 = 2, T3 = 3, T4 = 4, T5 = 5, T6 = 6 }

    [Serializable]
    public class StatBlock
    {
        public int atkMelee, atkMagic, atkRange;
        public int defStab, defSlash, defCrush, defMagic, defRange;
        public int strBonus, rngStrBonus, magDmgPercent;
        public int attack, defense, strength, ranged, magic, prayer, slayer, hitpoints;
        [NonSerialized] public int combatLevel;
    }

    [Serializable]
    public class ItemDef
    {
        public string id; public string displayName;
        public Rarity rarity; public Slot slot; public WeaponKind weaponKind;
        public bool tradeable = true; public bool degrades = false; public bool accountLocked = false;
        public string notes;
        public int strBonus; public int rngStrBonus; public int magDmgPercent;
    }

    [Serializable]
    public class SkillDef
    {
        public string id; public string displayName;
        public bool goroOnly = false; public bool godOnly = false;
        public School school = School.Normal;
        public DamageType damageType = DamageType.Magic;
        public float baseDamagePercent = 100f;
        public float cooldownSeconds = 0f;
        public bool ignoresDefense = false;
        public float ignoreDefensePlayers = 0f;
        public float ignoreDefenseMobs = 0f;
        public float ignoreDefenseBosses = 0f;
        public float bonusMagicPercent = 0f;
        public float bonusAccuracyPercent = 0f;
        public string description;
    }

    [Serializable]
    public class BossDefinition
    {
        public string id; public string displayName; public int level;
        public StatBlock stats = new();
        public List<string> skillIds = new();
        public bool isPlayable = false;
        public bool accountLocked = false; public string ownerAccountId;
    }
    #endregion

    #region API Client
    public static class API
    {
        public static string BaseUrl = "https://yourgameapi.com/api"; // <- set your server endpoint

        public static async Task<T> Get<T>(string path)
        {
            using var req = UnityWebRequest.Get(BaseUrl + path);
            req